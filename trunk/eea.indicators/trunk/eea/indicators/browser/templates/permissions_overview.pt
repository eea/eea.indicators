<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
	metal:use-macro="here/main_template/macros/master"
	i18n:domain="indicators">
	<head>
		<title>Permissions Overview for Indicators Database</title>
	</head>
	<body>
		<div metal:fill-slot="main">

			<h1>Permissions Overview for Indicators Database</h1>
			<tal:block define="queryString string:h2">
			    <metal:toc use-macro="here/portlet_toc/macros/portlet"/>
			</tal:block>

			<div tal:define="setcodes view/get_setcodes_map">
				<div tal:repeat="set setcodes">
					<h2 tal:content="set | string:Indicators without codes" />
					<table class="listing">
						<thead>
							<tr>
								<th>code</th>
								<th>indicator</th>
								<th>indicator manager</th>
								<th>state</th>
							</tr>
						</thead>
						<tbody>
							<tr tal:repeat="entry python:setcodes[set]">
								<td tal:define="codes entry/spec/getCodes">
									<span tal:condition="codes" 
										tal:define="info python:[code for code in codes if code['set'] == set][0]" 
										tal:content="string:${info/set}${info/code}">CSI 001</span>
								</td>
								<td>
									<a href="" 
										tal:attributes="href spec/absolute_url" 
										tal:define="spec python:entry['spec']" 
										tal:content="spec/Title">Spec title</a>
								</td>
								<td >
									<span tal:repeat="uid entry/userids" tal:content="uid" />
								</td>
								<td >
									<!-- <span tal:content="python:entry['state']" /> -->
									<span tal:content="entry/state" />
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</div>

	</body>
</html>
