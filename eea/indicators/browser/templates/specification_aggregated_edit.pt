<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
	metal:use-macro="here/main_template/macros/master"
	i18n:domain="indicators">

	<metal:jsslot fill-slot="javascript_head_slot">
		<script type="text/javascript" tal:attributes="src context/++resource++jquery.ui-1.7.js"></script>
		<script type="text/javascript" tal:attributes="src context/++resource++indicators.js"></script>
	</metal:jsslot>

	<metal:cssslot fill-slot="css_slot">
		<!-- TODO: temporary -->
		<!-- <link media="screen" type="text/css" rel="stylesheet"  -->
			<!-- 	tal:attributes="href context/++resource++eea.faceted-navigation-edit.css" /> -->
		<!-- <link media="screen" type="text/css" rel="stylesheet"  -->
			<!-- 	tal:attributes="href string:$portal_url/@@faceted_edit.css"  -->
			<!-- 	/> -->
	</metal:cssslot>

	<body>
		<div metal:fill-slot="main">

			<div id="dialog_edit_target"></div>
			<!-- <a href="javascript:dialog_edit('./simple_edit?fieldset=Methodology', 'Edit Methodology')">Show dialog</a> -->

			<h1 tal:content="context/Title">Title here</h1>
			<div metal:use-macro="here/portlet_themes_object/macros/portlet" />
			<div metal:use-macro="here/portlet_toc/macros/portlet" />

			<metal:versions use-macro="here/portlet_versions/macros/versions">
				<metal:new fill-slot="old" />
			</metal:versions>

			<h2>Assessment versions</h2>
			<h5>Published (reviewed and quality assured)</h5>
			<ul tal:define="assessments python:here.getFolderContents(contentFilter={'review_state':'published', 'portal_type':'Assessment'})">
				<li tal:condition="not:assessments">No published assessments</li>
				<li tal:repeat="brain assessments">
					<a tal:attributes="href python:brain.getObject().absolute_url()" tal:content="brain/Title">
						Assessment title here
					</a>
				</li>
			</ul>

			<h5>Draft (not yet published - not quality assured)</h5>
			<ul tal:define="assessments python:here.getFolderContents(contentFilter={'portal_type':'Assessment', 'review_state':'draft'})">
				<li tal:condition="not:assessments" >No drafts available</li>
				<li tal:repeat="brain python:assessments">
					<a tal:attributes="href python:brain.getObject().absolute_url()" tal:content="brain/Title">
						Assessment title here
					</a>
				</li>
			</ul>


			<div id="rationale">
				<div class="controls">
					<a href="./simple_edit?fieldset=Rationale&specific_field=rationale_justification">Edit Rationale Justification</a>
				</div>
				<h2 class="rationale">Rationale</h2>

				<h5>Justification for indicator selection</h5>
				<p tal:replace="structure context/rationale_justification">Rationale justification</p>

				<h5>Scientific references:</h5>
				<ul tal:define="refs python:context.objectValues('RationaleReference')">
					<li tal:repeat="ref refs">
						<a href="" tal:attributes="href ref/getRemoteUrl" tal:content="ref/Title">Ref title</a>
						<p tal:replace="structure ref/Description" />
					</li>
				</ul>
			</div>
			<script>
				$('#rationale').make_editable();
			</script>

			<h2 class="definition">Indicator definition</h2>
			<p tal:replace="structure context/getDefinition"></p>

			<h5>Units</h5>
			<p tal:replace="structure context/getUnits"></p>

			<h2 class="policy_context">Policy Context and targets</h2>

			<h5>Context description</h5>
			<p tal:content="structure context/getPolicy_context_description"></p>

			<h5>Targets</h5>
			<p tal:content="structure context/getPolicy_context_targets"></p>
			<h5>Related policy documents</h5>
			<ul>
				<li tal:repeat="doc context/getRelated_policy_documents">
					<a href="" tal:attributes="href doc/getRemoteUrl" tal:content="doc/Title">
						Doc title here
					</a>
					<div tal:content="structure doc/Description" />
				</li>
			</ul>

			<h2 class="policy_questions">Key policy question</h2>
			<div tal:repeat="question python:here.objectValues('PolicyQuestion')">
				<h5 tal:content="question/Title">Question title</h5>
			</div>

			<h2 class="methodology">Methodology</h2>

			<h5>Methodology for indicator calculation</h5>
			<p tal:content="structure context/getMethodology" />

			<h5>Methodology for gap filling</h5>
			<p tal:content="structure context/getMethodology_gapfilling" />

			<h5>Methodology references</h5>
			<ul tal:define="refs python:context.objectValues('MethodologyReference')">
				<li tal:repeat="ref refs">
					<a href="" tal:attributes="href ref/getRemoteUrl" tal:content="ref/Title">Ref</a>
					<p tal:replace="structure ref/Description" />
				</li>
			</ul>

			<h2 class="policy_questions">Data specifications</h2>
			<ul>
				<li tal:repeat="data context/getRelatedItems">
					<a href="" tal:attributes="href data/getDataset_url" tal:content="data/Title">Dataset title</a>
					<div tal:content="structure data/Description" />
				</li>
				<li tal:repeat="data context/getSpecification_data">
					<a href="" tal:attributes="href data/absolute_url" tal:content="data/Title">Dataset title</a>
					<div tal:content="structure data/Description" />
				</li>
			</ul>

			<h2 class="uncertainties">Uncertainties</h2>

			<h5>Methodology uncertainty</h5>
			<p tal:replace="structure context/getMethodology_uncertainty"></p>

			<h5>Data sets uncertainty</h5>
			<p tal:replace="structure context/getData_uncertainty"></p>

			<h5>Rationale uncertainty</h5>
			<p tal:replace="structure context/getRationale_uncertainty"></p>

			<h2 class="further_work">Further work</h2>
			<tal:def tal:define="works context/get_work; short works/short; long works/long">
				<h5>Short term work</h5>
				<p>Work specifed here requires to be completed within 1 year from now.</p>
				<div tal:repeat="work short">
					<h5>Work description</h5>
					<p tal:replace="structure work/Description"></p>
					<h5>Resource needs</h5>
					<p tal:replace="structure work/getNeeds"></p>
					<h5>Status</h5>
					<p tal:replace="structure work/getStatus"></p>
					<h5>Deadline</h5>
					<p tal:replace="structure work/getDue_date"></p>
				</div>
				<h5>Long term work</h5>
				<div tal:repeat="work long">
					<h5>Work description</h5>
					<p tal:replace="structure work/Description"></p>
					<h5>Resource needs</h5>
					<p tal:replace="structure work/getNeeds"></p>
					<h5>Status</h5>
					<p tal:replace="structure work/getStatus"></p>
					<h5>Deadline</h5>
					<p tal:replace="structure work/getDue_date"></p>
				</div>

			</tal:def>

			<metal:versions use-macro="here/portlet_versions/macros/versions">
				<metal:new fill-slot="new" />
			</metal:versions>

			<h2 class="metadata">General metadata</h2>

			<div class='headed-box'>
				<h5>Responsability and ownership</h5>

				<h6>EEA Contact Info:</h6>
				<div tal:content="structure context/getContact">...</div>

				<h6>Ownership</h6>
				<ul>
					<li tal:repeat="info context/getOwnership" >
						<a tal:content="python:context.getOrganisationName(info).Title" tal:attributes="href info">EEA</a>
					</li>
				</ul>

			</div>

			<div class='headed-box'>
				<h5>Identification</h5>
				<div class="wrapper" >
					<div tal:define="codes context/getCodes">
						<strong>CSI Code</strong>
						<div tal:repeat="code codes" tal:content="string:${code/set} ${code/code}">
							CSI 001
						</div>
					</div>
					<strong>Specification</strong>
					<div>Link: <a href="" tal:attributes="href context/absolute_url" 
							tal:content="context/getId">ISpecification1235</a>
					</div>
					<div>
						Version id: <span tal:content="context/getVersion_id" />
					</div>

					<div>
						First draft created: <span tal:content="context/creation_date">creation date</span>
					</div>

					<div>
						Publish date: <span tal:content="context/effective_date">effective date</span>
					</div>
					<div>
						Last modified: <span tal:content="context/modified">Modified date</span>
					</div>
				</div>
			</div>

			<div class='headed-box'>
				<h5>Classification</h5>
				<div class="visualClear"><!-- --></div>
				<strong>DPSIR</strong>: <span tal:replace="context/getDpsir" /><br/>
				<strong>Typology</strong>: <span tal:replace="context/getTypology" /><br/>
				<!-- <strong>EEA Themes</strong>: -->
				<!-- <ul> -->
					<!-- 	<li tal:repeat="theme context/getThemes" tal:content="theme" /> -->
					<!-- </ul> -->
			</div>

		</div>
	</body>
</html>
